#!/bin/bash


installvideo () {



case $video in

  "Automático")
# -*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* 
# Instalación de drivers de video 
# -*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* 
echo "" 
echo "Se estan instalando los drivers de video Automático" 
sleep 3 
case $(systemd-detect-virt) in 
	oracle)

		if [ "$kernel_select" == "linux-stable" ]; then
        
        arch-chroot /mnt /bin/bash -c "pacman -S virtualbox-guest-utils --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vmware --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S virtualbox-host-modules-arch --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxdrv"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxguest vboxsf vboxvideo"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxnetadp vboxnetflt vboxnetadp"
		arch-chroot /mnt /bin/bash -c "VBoxClient-all"
		arch-chroot /mnt /bin/bash -c "systemctl enable vboxservice.service"
		arch-chroot /mnt /bin/bash -c "systemctl enable systemd-modules-load.service"

		else

		arch-chroot /mnt /bin/bash -c "pacman -S virtualbox-guest-utils --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vmware --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S virtualbox-host-dkms --noconfirm" 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxdrv"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxguest vboxsf vboxvideo"
		arch-chroot /mnt /bin/bash -c "modprobe -a vboxnetadp vboxnetflt vboxnetadp"
		arch-chroot /mnt /bin/bash -c "VBoxClient-all"
		arch-chroot /mnt /bin/bash -c "systemctl enable vboxservice.service"
		arch-chroot /mnt /bin/bash -c "systemctl enable systemd-modules-load.service"

		fi
	;; 
	vmware) 
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vmware --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-input-vmmouse --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S open-vm-tools --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S net-tools --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S gtkmm --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
	;; 
	qemu) 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S mesa-libgl --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-fbdev --noconfirm"
	;; 
	kvm) 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S mesa-libgl --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-fbdev --noconfirm"
	;; 
	microsoft) 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S mesa-libgl --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-fbdev --noconfirm"
	;; 
	xen) 
		arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S mesa-libgl --noconfirm"
		arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-fbdev --noconfirm" 
	;; 
	*) 
		if (lspci | grep VGA | grep "NVIDIA\|nVidia" &>/dev/null); then 

			arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-nouveau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa-vdpau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-mesa-driver --noconfirm"

		elif (lspci | grep VGA | grep "Radeon R\|R2/R3/R4/R5" &>/dev/null); then 

			arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-amdgpu --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S vulkan-radeon --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-vulkan-radeon --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa-vdpau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-mesa-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa-vdpau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-libva-mesa-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-vdpau-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libvdpau-va-gl --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-utils --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S vdpauinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S opencl-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S clinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S opencl-headers --noconfirm"

		elif (lspci | grep VGA | grep "ATI\|AMD/ATI" &>/dev/null); then 

			arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-ati --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa-vdpau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-mesa-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa-vdpau --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-libva-mesa-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-vdpau-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libvdpau-va-gl --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-utils --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S vdpauinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S opencl-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S clinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S opencl-headers --noconfirm"

		elif (lspci | grep VGA | grep "Intel" &>/dev/null); then 

			arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-intel --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S vulkan-intel --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S intel-media-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-intel-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-vdpau-driver --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libvdpau-va-gl --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S libva-utils --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S vdpauinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S intel-compute-runtime --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S clinfo --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S lib32-ocl-icd --noconfirm"
			arch-chroot /mnt /bin/bash -c "pacman -S opencl-headers --noconfirm"

		else

			arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vesa --noconfirm"

	fi 
	;; 
esac 
sleep 2 

# -*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-* 
  ;;


  "Video_vesa_(Generic_All)")
	
	echo "" 
	echo "Se estan instalando los drivers de Video vesa (Generic All)" 
	arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vesa --noconfirm"

  ;;

  "Intel_(Open_Source)")
	
	echo "" 
	echo "Se estan instalando los drivers de Video Intel (Open Source)" 
	arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-intel --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S vulkan-intel --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S mesa --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S lib32-mesa --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S intel-media-driver --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S libva-intel-driver --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S libva-vdpau-driver --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S libvdpau-va-gl --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S libva-utils --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S vdpauinfo --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S intel-compute-runtime --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S clinfo --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S ocl-icd --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S lib32-ocl-icd --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S opencl-headers --noconfirm"

  ;;


  "AMD/ATI_(Open_Source)")
	
	echo "" 
	echo "Se estan instalando los drivers de Video vesa (Generic All)" 
	arch-chroot /mnt /bin/bash -c "pacman -S xf86-video-vesa --noconfirm"

  ;;


AMD/Radeon_(Open_Source)
Nvidia_(Open_Source)
Nvidia_Privativo_440xx_(Linux_Stable)
Nvidia_Privativo_390xx_(Linux_Stable)
Nvidia_Privativo_440xx_(Linux_LTS)
Nvidia_Privativo_390xx_(Linux_LTS)
Nvidia_Privativo_440xx_(Linux_Hardened_-_Zen)
Nvidia_Privativo_390xx_(Linux_Hardened_-_Zen)
Nvidia_Privativo_440xx_(Linux_Stable_+_Intel)


esac

}





installenvironment () {

	case $environment in

  "tty")
	echo "" 
	echo "Se esta instalando el entorno TTY:" 
	echo "" 
	arch-chroot /mnt /bin/bash -c "pacman -Syu --noconfirm"

  ;;


  "Xfce4")
	echo "" 
	echo "Se esta instalando el entorno Xfce4:" 
	echo "" 
	arch-chroot /mnt /bin/bash -c "pacman -S xorg --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-apps --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-xinit --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-twm --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xterm --noconfirm"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S xfce4 --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S xfce4-goodies --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S network-manager-applet --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S lightdm --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S lightdm-gtk-greeter --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S lightdm-gtk-greeter-settings --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S light-locker --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S accountsservice --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S mugshot --noeditmenu --noconfirm --needed"
 
 	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnu-free-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-hack --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-inconsolata --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-font-awesome --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S awesome-terminal-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts-emoji --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S nerd-fonts-hack --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbs --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S freetype2 --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S poppler-glib --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S raw-thumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "systemctl enable lightdm"

  ;;

  "Gnome")
	echo "" 
	echo "Se esta instalando el entorno Gnome:" 
	echo "" 

	arch-chroot /mnt /bin/bash -c "pacman -S xorg --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-apps --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-xinit --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-twm --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xterm --noconfirm"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnome-shell --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gdm --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnome-control-center --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnome-tweaks --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnome-terminal --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnu-free-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-hack --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-inconsolata --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-font-awesome --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S awesome-terminal-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts-emoji --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S nerd-fonts-hack --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbs --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S freetype2 --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S poppler-glib --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S raw-thumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "systemctl enable gdm"

  ;;


  "KDE-Plasma")
	echo "" 
	echo "Se esta instalando el entorno KDE Plasma:" 
	echo "" 

	arch-chroot /mnt /bin/bash -c "pacman -S xorg --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-apps --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-xinit --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xorg-twm --noconfirm"
	arch-chroot /mnt /bin/bash -c "pacman -S xterm --noconfirm"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S plasma --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S dolphin --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S konsole --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S discover --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S sddm --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libxcb --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S qt5-virtualkeyboard --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S gnu-free-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-hack --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-inconsolata --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ttf-font-awesome --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S awesome-terminal-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S noto-fonts-emoji --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S nerd-fonts-hack --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbs --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S ffmpegthumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S freetype2 --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S poppler-glib --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S raw-thumbnailer --noeditmenu --noconfirm --needed"
	arch-chroot /mnt /bin/bash -c "sudo -u $username yay -S libgsf --noeditmenu --noconfirm --needed"

	arch-chroot /mnt /bin/bash -c "systemctl enable sddm"

  ;;

esac

}



